!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.PL=e()}(this,function(){"use strict";function t(t){var e=document.createElement("link");return e.setAttribute("href",t.src),"script"!==t.type&&"module"!==t.type||e.setAttribute("as","script"),e.setAttribute("rel","preload"),e.setAttribute("data-from","PL"),document.head.appendChild(e),t.preloadRequested=!0,e}function e(t){if("script"===t.type||"module"===t.type){var e=document.createElement("script");return e.setAttribute("src",t.src),e.setAttribute("data-from","PL"),e.async=!1,"module"===t.type&&e.setAttribute("type","module"),document.head.appendChild(e),t.loadRequested=!0,e}return t.opts,null}function n(t){setTimeout(function(){throw t},0)}function r(t,e){for(var n in e)t[n]=e[n];return t}function i(t,e){var n=/^[\w\-]+:\/\/\/?/;return/^\/\/\/?/.test(t)?t=location.protocol+t:n.test(t)||"/"==t[0]||(t=(e||"")+t),n.test(t)||(t="/"==t[0]?P+t:L+t),t}function o(){function u(t){return v=r(v,t),g}function s(){return d().setOptions.apply(null,arguments)}function a(){return d().script.apply(null,arguments)}function c(){return d().wait.apply(null,arguments)}function l(t){this.isGroup=!0,this.resources=[],this.ready=!1,this.complete=!1,this.check=t||function(){}}function f(t,e){this.type=t,this.src=e,this.listeners=[],this.preloadRequested=!1,this.preloaded=!1,this.loadRequested=!1,this.complete=!1,this.opts=null}function p(t){t.src in m||(m[t.src]=new f(t.type,t.src));var e=m[t.src];return e.type||(e.type=t.type),e.opts||(e.opts=t.opts),~e.listeners.indexOf(t)||e.listeners.push(t),e}function h(t){for(var e=[],n=0;n<t.listeners.length;n++)~e.indexOf(t.listeners[n].group)||e.push(t.listeners[n].group);for(var r=0;r<e.length;r++)e[r].check()}function d(){function o(t){return y=r(y,t),E}function u(){for(var t=0;t<arguments.length;t++)a("script",arguments[t]);return f(),E}function s(){if(arguments.length>0)for(var t=0;t<arguments.length;t++)c(arguments[t]);else c(!0);return f(),E}function a(e,n){(0==b.length||!b[b.length-1].isGroup||b[b.length-1].complete||!T&&!j||y[x]&&!j)&&b.push(new l(f));var r=b[b.length-1];r.complete=!1,n="string"==typeof n?{type:e,src:i(n,y[B]),group:r}:{type:e,src:i(n.src,y[B]),opts:n,group:r},r.resources.push(n);var o=p(n);if(T&&!o.preloadRequested){var u=t(o);u.addEventListener("load",function t(){u.removeEventListener("load",t),u.parentNode.removeChild(u),o.preloaded=!0,h(o)})}}function c(t){if(0==b.length){var e=new l;e.ready=e.complete=!0,b.push(e)}b.push({wait:t})}function f(){null==w&&(w=setTimeout(d,0))}function d(){w=null;for(var t=0;t<b.length;t++)if(!b[t].complete)if(b[t].isGroup){if(g(b[t]),!b[t].complete)break}else if("function"==typeof b[t].wait)try{b[t].wait(),b[t].complete=!0}catch(t){y[R]?n(t):A(t);break}else b[t].complete=!0}function g(t){if(!t.ready&&!t.complete)if(T){for(var n=!0,r=0;r<t.resources.length;r++)if(!m[t.resources[r].src].preloaded){n=!1;break}t.ready=n}else t.ready=!0;if(!t.complete&&t.ready){for(var i=!0,o=0;o<t.resources.length;o++)!function(t){var n=m[t.src];if(n.loadRequested){if(n.complete)return;i=!1,~n.listeners.indexOf(t)||n.listeners.push(t)}else{var r=e(n);r.addEventListener("load",function t(){r.removeEventListener("load",t),n.complete=!0,h(n)}),i=!1}}(t.resources[o]);i&&(t.complete=!0)}}var y=r({},v),b=[],w=void 0,E={setOptions:o,script:u,wait:s};return E}var m={},v={};v[x]=!1,v[k]=!1,v[R]=!1,v[B]="",q&&function(){for(var t=0;t<O.length;t++)!function(t){if(t&&/\bpreload\b/i.test(t.getAttribute("rel"))){if(!t.getAttribute("as"))return;var e=t.getAttribute("href");e=i(e,document.baseURI);var n=window.performance.getEntriesByName(e);if(e in m)return;var r=new f(null,e);r.preloadRequested=!0,m[e]=r,n.length>0?r.preloaded=!0:t.addEventListener("load",function e(){t.removeEventListener("load",e),r.preloaded=!0,h(r)})}}(O[t])}();var g={setGlobalDefaults:u,setOptions:s,script:a,wait:c,sandbox:o};return g}function u(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"}function s(t){return u(t,"Array")}function a(t){return u(t,"String")}function c(t){return u(t,"Function")}function l(t){return u(t,"Object")}function f(t){if(s(t)){var e=t.length;!function e(n){n>=1&&(t[n]===t[n-1]&&t.splice(n,1),e(n-1))}(e-1)}return t}function p(t){if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var e="",n=t.split(":");if(1===n.length){if(a(C.path))return C.path+t;if(l(C.path))return(e=C.path.main||"")+t}return 2===n.length?(a(C.path)&&(e=C.path),l(C.path)&&C.path[n[0]]&&(e=C.path[n[0]]),e+n[1]):e}function h(t){var e="",n=t.split(":");if(1===n.length){if(a(C.path))return C.path;if(l(C.path))return C.path.main||""}return 2===n.length&&(a(C.path)&&(e=C.path),l(C.path)&&C.path[n[0]]&&(e=C.path[n[0]])),e}function d(t){var e=t.split(":");return 1===e.length?t:2===e.length?e[1]:void 0}function m(t,e){if(!e.isCalled){var n=!1;t.sheet&&(n=!0),n?setTimeout(function(){e()},1):setTimeout(function(){m(t,e)},1)}}function v(t,e){t.attachEvent?t.attachEvent("onload",e):setTimeout(function(){m(t,e)},0)}function g(t,e){if(!t||!a(t)||t.indexOf(".css")<0)return null;for(var n=t.lastIndexOf("/"),r=t.lastIndexOf(".css"),i=t.substring(n+1,r),o=p(t),u=document.getElementsByTagName("link"),s=document.createElement("link"),c=document.getElementsByTagName("head")[0],l=0;l<u.length;l++)if(u[l].href.indexOf(o)>-1)return null;return s.type="text/css",s.rel="stylesheet",s.href=o,s.setAttribute("data-mod",i),s.setAttribute("data-from","PL"),c.insertBefore(s,c.getElementsByTagName("link")[0]||null),s}function y(t,e){if(t){var n=[],r=s(t)?t:[t];r.forEach(function(t){c(e)?v(g(t),function(){n.push(!0)}):g(t)}),c(e)&&(G=setInterval(function(){(n.length===r.length||G>=C.timeout)&&(clearInterval(G),e&&c(e)&&e())},1))}}function b(t,e){t&&(s(t)?t.length>1?a(t[0])&&N.setOptions({BasePath:h(t[0])}).script(d(t[0])).wait(function(){b(t.slice(1),e)}):1===t.length&&N.setOptions({BasePath:h(t[0])}).script(d(t[0])).wait(e):a(t)&&N.setOptions({BasePath:h(t)}).script(d(t)).wait(e))}function w(t){return 1===I.rss.filter(function(e){return e===t}).length}var E=function(t){window.console.log(t)},A=function(t,e){window.console.error?window.console.error(t,e):E(t)},O=document.getElementsByTagName("link"),x="AlwaysPreserveOrder",k="CacheBust",R="Debug",B="BasePath",L=/^[^?#]*\//.exec(location.href)[0],P=/^[\w\-]+\:\/\/\/?[^\/]+/.exec(L)[0],T=function(){var t=document.createElement("link").relList;try{if(t&&t.supports)return t.supports("preload")}catch(t){}return!1}(),j=!0===document.createElement("script").async,q=window.performance&&window.performance.getEntriesByName,N=o(),C={},I=function t(e,n){n=n||function(){};var r=(s(e)?e:[e]).filter(function(t){return t&&"css"===t.type}).map(function(t){return t.link});C.enableRepeat||(r=f(r).filter(function(t){return!w(t)})),r.length>0&&(r.forEach(function(e){t.rss.push(e)}),r=r.reverse());var i=(s(e)?e:[e]).filter(function(t){return t&&"js"===t.type}).map(function(t){return t.link});C.enableRepeat||(i=f(i).filter(function(t){return!w(t)})),i.length>0?i.forEach(function(e){t.rss.push(e)}):i&&!c(n)||n(),r.length>0?y(r,function(){i.length>0?b(i,n):c(n)&&n()}):i.length&&b(i,n)};I.config=function(t){var e=t.path,n=void 0===e?"":e,r=t.enableRepeat,i=void 0!==r&&r,o=t.timeout,u=void 0===o?6e4:o;C.path=n,C.enableRepeat=i,C.timeout=u},I.rss=[];var G=0;I.use=function(t,e){var n=(s(t)?t:[t]).filter(function(t){return t&&a(t)&&".css"===t.substring(t.length-4)});C.enableRepeat||(n=f(n).filter(function(t){return!w(t)})),n.length>0&&(n.forEach(function(t){I.rss.push(t)}),n=n.reverse());var r=(s(t)?t:[t]).filter(function(t){return t&&a(t)&&".js"===t.substring(t.length-3)});C.enableRepeat||(r=f(r).filter(function(t){return!w(t)})),r.length>0&&r.forEach(function(t){I.rss.push(t)}),n.length>0?y(n,function(){r.length>0?b(r,e):c(e)&&e()}):r.length&&b(r,e)};var D=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};return function(t){var e=t.config,n=void 0===e?{}:e,r=t.libs,i=void 0===r?[]:r,o=t.styles,u=void 0===o?[]:o,s=t.exs,a=void 0===s?[]:s,c=t.loaded,l=void 0===c?function(){}:c;I.config(n);var f=u.map(function(t){return{type:"css",link:t}}),p=[].concat(D(i),D(a)).map(function(t){return{type:"js",link:t}});I([].concat(D(f),D(p)),l)}});
